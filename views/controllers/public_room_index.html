<link rel="import" href="{$components_url}bower_components/paper-header-panel/paper-header-panel.html">
<link rel="import" href="{$components_url}bower_components/paper-toolbar/paper-toolbar.html">
<link rel="import" href="{$components_url}bower_components/paper-material/paper-material.html">
<link rel="import" href="{$components_url}bower_components/paper-icon-button/paper-icon-button.html">
<link rel="import" href="{$components_url}bower_components/paper-tooltip/paper-tooltip.html">
<link rel="import" href="{$components_url}bower_components/iron-icons/iron-icons.html">
<link rel="import" href="{$components_url}bower_components/iron-icons/social-icons.html">
<link rel="import" href="{$components_url}bower_components/iron-flex-layout/iron-flex-layout.html">

<link rel="import" href="{$components_url}datalets/graph-datalet/graph-datalet.html">
<link rel="import" href="{$components_url}datalets/graph-datalet/graph-with-clustering-datalet.html">
<link rel="import" href="{$components_url}bower_components/paper-fab-transitions/paper-fab-speed-dial.html">

<link rel="import" href="{$components_url}bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="{$components_url}bower_components/paper-spinner/paper-spinner-lite.html">

<link rel="import" href="{$components_url}bower_components/paper-spinner/paper-spinner.html">
<link rel="import" href="{$components_url}bower_components/paper-spinner/paper-spinner-lite.html">

<base target="_parent" />

<style is="custom-style">

    paper-spinner {
        height: 64px;
        width: 64px;
        top: 50%;
        left: 50%;

        --paper-spinner-stroke-width: 8px;
        --paper-spinner-layer-1-color: #2196F3;
        --paper-spinner-layer-2-color: #F44336;;
        --paper-spinner-layer-3-color: #FFEB3B;;
        --paper-spinner-layer-4-color: #4CAF50;;
    }

    paper-toolbar.toolbar-main
    {
        --paper-toolbar-background:#2196F3;
        -moz-box-shadow: 0 0 20px 5px #999;
        -webkit-box-shadow: 0 0 20px 5px #999;
        --paper-toolbar-height : 40px;
        z-index : 100;
    }
    paper-toolbar.title-header{
        --paper-toolbar-background:#2196F3;
        -moz-box-shadow: 0 0 20px 5px #999;
        -webkit-box-shadow: 0 0 20px 5px #999;
        margin-bottom: 10px;
        height: 30px;
    }
    paper-fab{
        --paper-fab-background:#2196F3;
    }
    paper-fab.show_datalet{
        --iron-icon-height: 18px;
        --iron-icon-width:  18px;
        height: 22px;
        width:  22px;
        padding: 0px;
    }

    paper-fab-speed-dial{

    }

    paper-fab.sentiment-button
    {
        float: left;
        /*--paper-fab-background:#2196F3;*/
        --iron-icon-height: 16px;
        --iron-icon-width:  16px;
        height: 20px;
        width:  20px;
        left: 2px;
        background-color: #2196F3;
        padding: 0px;
        box-shadow:none;
    }

    /*paper-fab.sentiment-button[sentiment="1"]*/
    /*{*/
        /*background-color: #2196F3;*/
    /*}*/

    paper-fab.sentiment-button[sentiment="2"]
    {
        background-color: #4CAF50;
    }

    paper-fab.sentiment-button[sentiment="3"]
    {
        background-color: #F44336;
    }

    paper-header-panel{
        /*height: 8vh;;*/
    }

    .title h4{
        color: #ffffff;
    }

    #graph_container{
        margin-top: 3px;
        width: 48.8%;
        display: none;

    }

    #graph_content{
        position: relative;
        overflow: auto;
        height: 90vh;
    }

    #topic_container{
        position: relative;
        overflow: auto;
        height: 93vh;
        width: 100%;
        margin-left: 5px;
        margin-right: 5px;
    }

    #pr_body{
        font-family: 'Roboto', sans-serif;
        display: inline-block;
        color: #6c6c6c;
        font-weight: bolder;
        font-size: 20px;
        margin: 30px;
        padding-right: 10px;
        padding-left: 10px;
        font-style: italic;
        margin-top: 25px;
    }

    .q-comments{
        padding-left: 4.5%;
        width: 90%;
        font-size: 14px;
    }

    #graphs_buttons_panel{
        display: none;
    }

    #toolbar-graph-title{
        color: #ffffff;
        margin-left: 30px;
        width: 331px;
    }

    paper-dialog {
        padding : 10px;
        border: 2px solid;
        border-color: #2196F3;
        /*background-color: var(--paper-light-green-50);*/
        height: 80%;
        overflow: scroll;
    }

    .public_room_comment_container
    {
        background-color: #efefef;
    }

    .datalet_placeholder
    {
        display: none;
    }

    #preloader_container
    {
        position: fixed;
        top: 0;
        left: 0;
        height: 100%;
        width: 100%;
        background-color: rgba(0, 0, 0, 0.5);
        display: none;
    }

    .loader_spinner
    {
        height: 100%;
        width: 100%;
    }

</style>

{style}
#button_container { display: none; }

body .floatbox_canvas .floatbox_container{ margin-top:10px; }
{/style}

{literal}
<script type="text/javascript">
    $(document).ready(function(){

        $(".show_datalet").live("click", function(e){

            //var datalet_placeholder = $(e.currentTarget).parents().eq(3).find(".datalet_placeholder");
            var datalet_placeholder = $(e.currentTarget).parent().find(".datalet_placeholder");

            datalet_placeholder.toggle('fade',
                {direction: 'top'},
                function(){
                    if(datalet_placeholder.css('display') == 'none')
                        $(e.currentTarget).css('background', '#2196F3');
                    else
                        $(e.currentTarget).css('background', '#5B646A');

                //resize the datalet when is opened
                var datalet = $(datalet_placeholder.children()[1])[0];
                if(datalet.refresh != undefined)
                    datalet.refresh();
                else
                    datalet.behavior.presentData();
            },
            500);

            //$("#topic_container").scrollTop(datalet_placeholder.parents().eq(2));
        });

    });
</script>
{/literal}

<script src="https://cdn.socket.io/socket.io-1.2.0.js"></script>

<paper-header-panel>
    <paper-toolbar class="toolbar-main">
        <!--<paper-icon-button id="helper" paper-drawer-toggle icon="help-outline" onClick="ODE.showHelper()"></paper-icon-button>-->
        <div class="title"><h4>{$public_room->subject}</h4></div>
        <div id="graphs_buttons_panel">
            <paper-icon-button id="comment_graph" paper-drawer-toggle icon="speaker-notes" onClick="commentGraphShow()"></paper-icon-button>
            <paper-tooltip for="comment_graph">{text key="spodpublic+comments_graph"}</paper-tooltip>
            <paper-icon-button id="datalet_graph" paper-drawer-toggle icon="assessment" onClick="dataletGraphShow()"></paper-icon-button>
            <paper-tooltip for="datalet_graph">{text key="spodpublic+datalets_graph"}</paper-tooltip>
            <paper-icon-button id="user_graph" paper-drawer-toggle icon="account-circle" onClick="usersGraphShow()"></paper-icon-button>
            <paper-tooltip for="user_graph">{text key="spodpublic+users_graph"}</paper-tooltip>
            <paper-icon-button id="opinion_graph" paper-drawer-toggle icon="face" onClick="opinionsGraphShow()"></paper-icon-button>
            <paper-tooltip for="opinion_graph">{text key="spodpublic+opinions_graph"}</paper-tooltip>
        </div>
        <h5 id="toolbar-graph-title">{text key="spodpublic+graph_panel"}</h5>
        <paper-icon-button id="slide_graph_button" paper-drawer-toggle icon="picture-in-picture" onClick="slideGraphPanel()"></paper-icon-button>
        <paper-tooltip for="slide_graph_button">{text key="spodpublic+open_graph_panel"}</paper-tooltip>
    </paper-toolbar>
</paper-header-panel>

<div class="layout horizontal public_room_comment_container">
    <paper-material id="topic_container" class="layout justified">
        <paper-material elevation="0" id="pr_body">
            {$public_room->body}
        </paper-material>
        {if !empty($comments)}
        <div class="q-comments">
            {$comments}
        </div>
        {/if}
    </paper-material>

    <paper-material elevation="1" animated id="graph_container">
        <div id="graph_content"></div>
    </paper-material>
</div>

<div id="preloader_container">
    <paper-spinner id="datalet_spinner" active></paper-spinner>
</div>

<!-- ODE PRIVATE-ROOM -->
<div>
    {if isset($private_room)}
    {$private_room}
    {/if}
</div>
<!-- ODE PRIVATE-ROOM -->